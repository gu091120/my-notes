#前端日志监控

## 采集

收集异常日志，先在本地做一定的处理，采取一定的方案上报到服务器。

### 日志分类

-   `info`:正常运行
-   `warrn`:出现卡顿，但是能正常使用
-   `error`:出现不能正常使用的错误

### 采集内容

-   用户信息：出现异常时该用户的信息，例如该用户在当前时刻的状态、权限等，以及需要区分用户可多终端登录时，异常对应的是哪一个终端。
-   行为信息 ：用户进行什么操作时产生了异常：所在的界面路径；执行了什么操作；操作时使用了哪些数据；当时的 API 吐了什么数据给客户端；如果是提交操作，提交了什么数据；上一个路径；上一个行为日志记录 ID 等。
-   异常信息：产生异常的代码信息：用户操作的 DOM 元素节点；异常级别；异常类型；异常描述；代码 stack 信息等。
-   环境信息：网络环境；设备型号和标识码；操作系统版本；客户端版本；API 接口版本等。

### 错误分类

|   错误类型   |                               错误内容                               | 出现频率 |
| :----------: | :------------------------------------------------------------------: | :------: |
|   逻辑错误   |                 1、业务逻辑错误 2、错误操作 js 对象                  |   较多   |
| 数据类型错误 | 1、将 undefined 视作数组进行遍历 2、将字符串形式的数字直接用于加运算 |   较多   |
|   语法错误   |                         1、使用不兼容的语法                          |   较少   |
|   网络错误   |                         1、使用不兼容的语法                          |   较少   |
|   系统错误   |                           1、 壳不支持 API                           |   较少   |

## 存储

后端接收前端上报的异常日志，经过一定处理，按照一定的存储方案存储。

## 分析

分为机器自动分析和人工分析。机器自动分析，通过预设的条件和算法，对存储的日志信息进行统计和筛选，发现问题，触发报警。人工分析，通过提供一个可视化的数据面板，让系统用户可以看到具体的日志数据，根据信息，发现异常问题根源。

## 警报

分为告警和预警。告警按照一定的级别自动报警，通过设定的渠道，按照一定的触发规则进行。预警则在异常发生前，提前预判，给出警告。
